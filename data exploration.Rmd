---
title: "Data Exploration"
author: "Gage Clawson"
date: "2/4/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load packages
library(tidyverse)
library(tidyr)
library(RColorBrewer)
library(janitor)
library(chron)



```


```{r}
#Load the data
oil_accidents_raw <- read_csv("database.csv")
```

```{r}
# Initial data cleanup and wrangling

oil_accidents <- oil_accidents_raw %>%
  clean_names() %>% #clean the names snake case
  select(report_number, accident_year:liquid_type, accident_city:cause_category, net_loss_barrels:restart_date_time, property_damage_costs:all_costs) %>% #select relevant columns
  separate(accident_date_time, c("day", "month", "year", "hour", "minute" ,"am_or_pm"), by = c("/", " ")) %>%  #separate the date time column
  unite("time", hour, minute, sep = ":") %>% #bring time back together
  unite("time", time, am_or_pm, sep = " ") %>% #bring time back together
  filter(accident_year != 2017) %>% #filter out the 2 2017 observations
  unite("date", year,month,day, sep = "-") %>% #make the date column again
  mutate(date = as.Date(date)) #change date to date standard internation date format 
  
#check 
```


```{r}
sum_df <- oil_accidents %>%
  group_by(accident_year) %>%
  summarise(count_accidents = length(report_number))

## graph in shiny we will be able to select what state
ggplot(sum_df, aes(x = accident_year, y = count_accidents)) +
  geom_point() +
  geom_line()
```



